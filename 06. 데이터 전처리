ğŸ“¦ pandas ê°œìš”
pandasëŠ” ë°ì´í„° ì „ì²˜ë¦¬ì— ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” íŒŒì´ì¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.

ìì£¼ ì‚¬ìš©í•˜ëŠ” pandas í•¨ìˆ˜
query() : ì¡°ê±´ì— ë§ëŠ” í–‰ ì¶”ì¶œ
df[] : ë³€ìˆ˜(ì—´) ì¶”ì¶œ
sort_values() : ì •ë ¬
groupby() : ì§‘ë‹¨ë³„ í†µê³„
assign() : íŒŒìƒë³€ìˆ˜ ì¶”ê°€
agg() : ìš”ì•½ í†µê³„
merge() : ê°€ë¡œ ë°©í–¥ ê²°í•©
concat() : ì„¸ë¡œ ë°©í–¥ ê²°í•©

ğŸ§© ê¸°ë³¸ ë¬¸ë²•
âœ… ë…¼ë¦¬/ì‚°ìˆ  ì—°ì‚°ì
ë…¼ë¦¬ ì—°ì‚°ì : <, <=, >, >=, ==, !=, |, &, in

ì‚°ìˆ  ì—°ì‚°ì : +, -, *, **, /, //, %

ğŸ” í–‰ ì¶”ì¶œ (query())
exam.query('nclass == 1')
exam.query('nclass == 1 & math > 50')
exam.query('math >= 90 | english >= 90')
exam.query('nclass in [1, 3, 5]')

ğŸ“Œ ë³€ìˆ˜(ì—´) ì¶”ì¶œ ë° ì œê±°
âœ… ë³€ìˆ˜ ì¶”ì¶œ
exam['math']                          # ì‹œë¦¬ì¦ˆ í˜•íƒœ
exam[['math']]                        # ë°ì´í„°í”„ë ˆì„ ìœ ì§€
exam[['nclass', 'math', 'english']]  # ì—¬ëŸ¬ ì—´ ì¶”ì¶œ

âŒ ë³€ìˆ˜ ì œê±°
exam.drop(columns='math')
exam.drop(columns=['math', 'english'])

âœ… ì¡°ê±´ + ì—´ ì¶”ì¶œ
exam.query('nclass == 1')['english']
exam.query('nclass == 1')['english'].head()

# ê°€ë…ì„± ì¢‹ê²Œ ì‘ì„±
exam.query('nclass == 1') \
    [['english']] \
    .head()

ğŸ”¢ ì •ë ¬ (sort_values())
exam.sort_values('math')  # ì˜¤ë¦„ì°¨ìˆœ
exam.sort_values('math', ascending=False)  # ë‚´ë¦¼ì°¨ìˆœ
exam.sort_values(['nclass', 'math'])  # ì—¬ëŸ¬ ê¸°ì¤€ ì •ë ¬
exam.sort_values(['nclass', 'math'], ascending=[True, False])

â• íŒŒìƒë³€ìˆ˜ ì¶”ê°€ (assign())
exam.assign(total = exam['math'] + exam['english'] + exam['science'])

exam.assign(
    total = exam['math'] + exam['english'] + exam['science'],
    mean = (exam['math'] + exam['english'] + exam['science']) / 3
)

# ì¡°ê±´ ê¸°ë°˜ íŒŒìƒë³€ìˆ˜
import numpy as np
exam.assign(test = np.where(exam['science'] > 60, 'pass', 'fail'))

# assign ì´í›„ ì •ë ¬
exam.assign(test = np.where(exam['science'] > 60, 'pass', 'fail')) \
    .sort_values('total')

# lambdaë¡œ í‘œí˜„ ê°„ì†Œí™”
long_name.assign(new = lambda x: x['math'] + x['english'] + x['science'])

ğŸ“Š ì§‘ë‹¨ë³„ ìš”ì•½ (groupby() + agg())
# ë‹¨ì¼ ë³€ìˆ˜ í‰ê· 
exam.agg(mean_math = ('math', 'mean'))

# ì§‘ë‹¨ë³„ í‰ê· 
exam.groupby('nclass').agg(mean_math = ('math', 'mean'))

# ì¸ë±ìŠ¤ ìœ ì§€ X
exam.groupby('nclass', as_index=False).agg(mean_math = ('math', 'mean'))

# ì—¬ëŸ¬ í†µê³„ëŸ‰
exam.groupby('nclass').agg(
    mean_math = ('math', 'mean'),
    sum_math = ('math', 'sum'),
    median_math = ('math', 'median'),
    n = ('nclass', 'count')
)

# ëª¨ë“  ìˆ˜ì¹˜ ë³€ìˆ˜ ìš”ì•½
exam.groupby('nclass').mean()

# ë‹¤ì¤‘ ê·¸ë£¹ ê¸°ì¤€
mpg.groupby(['manufacturer', 'drv']).agg(mean_cty = ('cty', 'mean'))

# ë¹ˆë„ìˆ˜ êµ¬í•˜ê¸°
mpg.groupby('drv').agg(n = ('drv', 'count'))

# ì‹œë¦¬ì¦ˆ ë¹ˆë„ìˆ˜ (query ì‚¬ìš© ë¶ˆê°€)
mpg['drv'].value_counts()

ğŸ§  pandas í•¨ìˆ˜ ì¡°í•© ì˜ˆì œ
Q. ì œì¡° íšŒì‚¬ë³„ë¡œ 'suv' ìë™ì°¨ì˜ ë„ì‹œ ë° ê³ ì†ë„ë¡œ ì—°ë¹„ í‰ê· ì„ êµ¬í•´ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬ í›„ ìƒìœ„ 5ê°œ ì¶œë ¥í•˜ê¸°
mpg.query('category == "suv"') \
    .assign(total = (mpg['hwy'] + mpg['cty']) / 2) \
    .groupby('manufacturer') \
    .agg(mean_tot = ('total', 'mean')) \
    .sort_values('mean_tot', ascending=False) \
    .head()

ğŸ”— ë°ì´í„° ê²°í•©
â¡ï¸ ê°€ë¡œë¡œ ê²°í•© (merge)
pd.merge(test1, test2, how='left', on='id')

â¬‡ï¸ ì„¸ë¡œë¡œ ê²°í•© (concat)
pd.concat([group_a, group_b])
ì„¸ë¡œ ê²°í•© ì‹œ ì—´ ì´ë¦„ì´ ë™ì¼í•´ì•¼ í•¨. í•„ìš” ì‹œ rename() ì‚¬ìš©
